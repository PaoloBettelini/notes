\documentclass{article}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{parskip}
\usepackage{fullpage}
\usepackage{hyperref}
\usepackage{pgfplots}
\usepackage{wrapfig}
\usetikzlibrary{calc}

\hypersetup{
    colorlinks=true,
    linkcolor=black,
    urlcolor=blue,
    pdftitle={DifferentialEquations},
    pdfpagemode=FullScreen,
}

\renewcommand\qedsymbol{\(\blacksquare\)}

\newtheorem*{theorem1}{Theorem}
\newtheorem*{theorem2}{Theorem}
\newtheorem*{theorem3}{Theorem}
\newtheorem*{theorem4}{Theorem}
\newtheorem*{theorem5}{Theorem}
\newtheorem*{theorem6}{Theorem}

\title{Differential Equations}
\author{Paolo Bettelini}
\date{}

\begin{document}

\maketitle
\tableofcontents
\pagebreak

\section{Definition}

Differential equations are equations where the solution is a function
or a set of functions.

\section{First-Order Differential Equations}

A first-order differential equation is a differential equation in the form
\[
    y'(t)=f(t,y(t))
\]
where \(f\) is given.

The equation is said to be \textit{linear}
iff \(f\) is linear on the second argument.
\[
    y'(t)=a(t)y(t) + b(t)
\]
The equation is also said to be \textit{constant}
iff \(a\) and \(b\) are also constant.

\subsection{Linear Constant Coefficients Differential Equations}

\begin{theorem1}
    The general solution to the constant differential equation
    \[
        y' = ay+b,
        \quad a \neq 0
    \]
    is given by
    \[
        y(t)=Ce^{at}-\frac{b}{a}, \quad C \in \mathbb{R}
    \]
\end{theorem1}
\begin{proof}
    Let's first consider the case when \(b=0\),
    \[
        y'=ay
    \]
    We divide both sides by \(y\) and simplify
    \[
        \frac{y'}{y}=a
        \implies
        \ln|y|'=a
        \implies
        \ln|y|=at+c_0
    \]
    concluding that
    \[
        y = \pm e^{at+c_0}=\pm e^{c_0} \cdot e^{at} = Ce^{at}
    \]
    Now let's consider \(b \in \mathbb{R}\)
    \[
        y'=a\left(y+\frac{b}{a}\right)
        \implies
        \left(y + \frac{b}{a}\right)' = a\left(y + \frac{b}{a}\right)
    \]
    Note that \(\frac{d}{dx}\left(\frac{b}{a}\right)=0\) \\
    Denoting \(\tilde{y}=y+\frac{b}{a}\), we have
    \[
        \tilde{y}=a\tilde{y}
    \]
    which has solution \(Ce^{at}\), hence
    \begin{align*}
        y+\frac{b}{a}&=Ce^{at} \\
        y &= Ce^{at} - \frac{b}{a}
    \end{align*}
\end{proof}

\pagebreak

It is important to note that we solved the equation by turning
it into a total derivative, which is simple to integrate \((\ln|y|'=a)\).
This function is called a \textit{potential function} \((\psi)\) and it's how
the equation is transformed into a total derivative
\[
    y'=ay+b \rightarrow \psi(t, y(t))'=0
\]
In this case
\[
    \psi = \ln|y| - at
\]

\paragraph{The Integrating Factor Method}
The integrating factor method is a method for solving linear
differential equations.
\\
We will prove the theorem again using this method.
\begin{proof}
    We choose an integrating factor to be a function \(\mu\) such that
    \[
        \mu'=-a\mu
    \]
    By solving this differential equation we get
    \[
        \frac{\mu'}{\mu} = -a
        \implies
        \ln|\mu| = -at+C
        \implies
        \mu(t) = Ce^{-at}
    \]
    Now we multiply the equation by \(\mu\)
    \begin{align*}
        y'-ay&=b \\
        y'\mu - \mu ay &= b\mu \\
        y'\mu + \mu' y &= b \mu \\
        (\mu y)' &= \mu b
    \end{align*}
    Now choosing \(C=1\)
    \begin{align*}
        \left(e^{-at}y\right)'&=be^{-at} \\
        \left(e^{-at}y\right)'&=\left(-\frac{b}{a}e^{-at}\right)' \\
        \left(e^{-at}y+\frac{b}{a}e^{-at}\right)' &= 0 \\
        \left[\left(\frac{b}{a} + y\right)e^{-at}\right]' &= 0
    \end{align*}
    Now the differential equation is a total derivative of the potential function,
    which in this case in
    \[
        \psi(t, y) = \left(\frac{b}{a} + y\right)e^{-at}
    \]
    This is easy to integrate
    \[
        \left(\frac{b}{a} + y\right)e^{-at} = C
        \implies
        y = Ce^{at} - \frac{b}{a}
    \]
\end{proof}

\pagebreak

\subsection{Linear Constant Coefficients Differential Equations with Initial Point}

We want to constraint the equation such that it has an unique solution
rather than infinite solutions.
\[
    y' = ay + b, \quad y(t_0) = y_0
\]

\begin{theorem2}
    The genera solution to the ordinary constant differential equation
    \[
        y' = ay + b,
    \]
    with a given point
    \[
        y(t_0) = y_0
    \]
    is given by
    \[
        y(t)=\left(y_0 + \frac{b}{a}\right) e^{a(t-t_0)}- \frac{b}{a},
        \quad a \neq 0
    \]
\end{theorem2}
\begin{proof}
    Starting from the general solution of a constant ordinary differential equation
    \[
        y(t_0) = y_0 = Ce^{at_0} - \frac{b}{a}
    \]
    meaning that
    \[
        C = \left(y_0 + \frac{b}{a}\right) e^{-at_0}
    \]
    this constraints out result to
    \begin{align*}
        y(t) &= Ce^{at} - \frac{b}{a} \\
             &= \left(y_0 + \frac{b}{a}\right) e^{-at_0} e^{at} - \frac{b}{a} \\
             &= \left(y_0 + \frac{b}{a}\right) e^{a(t-t_0)} - \frac{b}{a}
    \end{align*}
\end{proof}

\subsection{Linear Variable Coefficients Differential Equations}

An ordinary linear differential equation with variable coefficients is defined as
\[
    y' = a(t)y(t) + b(t)
\]
The solution to the linear equation with constant coefficients still applies
if \(\frac{b}{a}\) is constant.

\begin{theorem3}
    The general solution to the differential equation
    \[
        y' = a(t)y(t) + b(t)
    \]
    is given by
    \[
        y(t)=Ce^{A(t)} + e^{A(t)} \int e^{-A(t)} b(t)\, dt
    \]
    where \(A(t)=\int a\,dt\), \(c\in\mathbb{R}\) and \(a\) and \(b\) are
    continuous.
\end{theorem3}
\begin{proof}
    Let's start by letting \(b(t)=0\)
    \[
        y' = ay
        \implies
        \frac{y'}{y}=a
        \implies
        \ln|y|'=a
        \implies
        \ln|y|=\int a\,dt
    \]
    concluding that
    \[
        y = \pm e^{A+c_0}=\pm e^{c_0} \cdot e^{A} = Ce^A
    \]
    where \(A=\int a\, dt\).
    \\
    As previosuly, we choose an integrating factor \(\mu\) such that
    \[
        -a\mu = \mu'
    \]
    By solving this differential equation we get
    \[
        \frac{\mu'}{\mu} = -a
        \implies
        \ln|\mu| = -A+C
        \implies
        \mu(t) = Ce^{-A}
    \]
    And by choosing \(C=1\) we have
    \[
        \mu(t) = e^{-A(t)}
    \]
    Now we multiply our equation by the integrating factor
    \begin{align*}
        y' - ay &= b \\
        y'\mu - a\mu y &= \mu b \\
        y' \mu + \mu' y &= \mu b \\
        \left(y \mu\right)' &= \mu b \\
        \left(e^{-A(t)}y\right)' &= e^{-A(t)}b \\
        e^{-A(t)}y &= \int e^{-A(t)}b \,dt + C \\
        y(t) &= Ce^{A(t)} + e^{A(t)} \int e^{-A(t)}b \,dt
    \end{align*}
\end{proof}

\subsection{Linear Variable Coefficients Differential Equations with Initial Point}

A linear differential equation with variable coefficients and an initial point is given by
\[
    y'(t) = a(t)y(t) + b(t), \quad
    y(t_0) = y_0
\]

\begin{theorem4}
    TODO % 18 (26 / 431)
\end{theorem4}

\pagebreak

\subsection{Bernoulli Equation}

The Bernoulli equation has the form
\[
    y' = p(t)y + q(t)y^n
\]

\begin{theorem5}
    The general solution of the Bernoulli equation is the general
    solution of the linear equation
    \[
        v' = -(n-1)p(t)v-(n-1)q(t)
    \]
    where
    \[
        v = \frac{1}{y^{n-1}}
    \]
\end{theorem5}
\begin{proof}
    They idea is to transform this equation into a simplier
    linear first-order equation. \\
    Start by dividing both sides by \(y^n\)
    \[
        \frac{y'}{y^n} = \frac{p(t)}{y^{n-1}} + q(t)
    \]
    Let
    \[
        v = y^{-(n-1)}, 
        \quad
        v' = -(n-1)y^{-n}y'
    \]
    Thus
    \[
        -\frac{v'}{n-1} = \frac{y'(t)}{y^n(t)}
    \]
    By substituting we get
    \begin{align*}
        -\frac{v'}{n-1} &= p(t)v + q(t) \\
        v' &= -(n-1)p(t)v-(n-1)g(t)
    \end{align*}
\end{proof}

\pagebreak

\subsection{Separable equations}

Separable equations are equations that can be solved by integrating both sides.
This doesn't generally work with first-order linear wquations.
A separable equation has the form
\[
    h(h)h'=g(t)
\]
\begin{theorem6}
    A separable differential equation has solutions where
    \[
        H(y(t)) = G(t) + C
    \]
    where
    \begin{align*}
        H = \int h(y)\,dy
        ,\quad
        G = \int g(t)\,dt
    \end{align*}
\end{theorem6}
\begin{proof}
    Start by integrating both sides of the equation
    \[
        \int h(g(t))g'(t)\,dt =
        \int g(t)\,dt + C
    \]
    Now substitute for
    \[
        s=y(t),
        \quad
        ds=y'(t)\,dt
    \]
\end{proof}

\pagebreak

\section{Slope Field}

A slope field or directional field is a field to visualize
solutions to a first-order differential equation.

\begin{wrapfigure}[15]{l}{7.5cm} % 10 is the number of wrapfigure lines
    \begin{tikzpicture}[declare function={f(\x,\y)=\x+\y;}]
        \def\xmax{3} \def\xmin{-3}
        \def\ymax{3} \def\ymin{-3}
        \def\nx{15}
        \def\ny{15}
        
        \pgfmathsetmacro{\hx}{(\xmax-\xmin)/\nx}
        \pgfmathsetmacro{\hy}{(\ymax-\ymin)/\ny}
        \foreach \i in {0,...,\nx}
            \foreach \j in {0,...,\ny}{
                \pgfmathsetmacro{\yprime}{f({\xmin+\i*\hx},{\ymin+\j*\hy})}
                \draw[blue,shift={({\xmin+\i*\hx},{\ymin+\j*\hy})}] 
                (0,0)--($(0,0)!2mm!(.1,.1*\yprime)$);
            }
        
        % a solution y=(yo+1)e^x-x-1
        \def\yo{1}
        \draw[magenta] plot[domain=\xmin:.9] (\x,{(\yo+1)*exp(\x)-\x-1});
        
        \draw[->] (\xmin-.5,0)--(\xmax+.5,0) node[below right] {\(x\)};
        \draw[->] (0,\ymin-.5)--(0,\ymax+.5) node[above left] {\(y\)};
        
        \draw (current bounding box.south) node[below]
        {Slope field of \quad \(\frac{dy}{dx}=x+y\).};
    \end{tikzpicture}

\end{wrapfigure}

\phantom{ } \\

This field is obtained by picking points on the plane. \\
For each point \((x,y)\) we know that the slope \((\frac{dy}{dx})\)
is \(x + y\). \\
This means that if a solution passes through \((x,y)\), then its slope is \(x+y\). \\
The red curve shows a solution.

% this is embarassing
% I don't know how to deal with wrapfig
\phantom{ } \\
\phantom{ } \\
\phantom{ } \\
\phantom{ } \\
\phantom{ } \\
\phantom{ } \\
\phantom{ } \\
\phantom{ } \\
\phantom{ } \\
\phantom{ } \\
\phantom{ } \\

\section{Euler's Method}

Euler's method is a technique for solving a 
first-order differential equation numerically given a point of the solution.
\\
Starting at the known solution point \(A_0\), we take small steps the direction
of the slope field. As the length of the steps \(s \to 0\)
we approach the solution to the equation. \\
The angle of the slope is given by
\[
    \theta = \tan\left(\frac{dy}{dx}\right)
\]
so each step gives the sequence of points
\[
    A_n = A_{n-1} \cdot s \left(\cos(\theta), \sin(\theta)\right)
\]

\pagebreak

% reference https://users.math.msu.edu/users/gnagy/teaching/ode.pdf

\end{document}
